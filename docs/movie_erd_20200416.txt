
-- theater Table Create SQL
CREATE TABLE theater
(
    `theater_id`      INT             NOT NULL    AUTO_INCREMENT COMMENT '극장 ID', 
    `theater_name`    VARCHAR(45)     NOT NULL    COMMENT '극장명', 
    `theater_addr`    VARCHAR(500)    NOT NULL    COMMENT '극장주소', 
    `theater_tel_no`  VARCHAR(50)     NOT NULL    COMMENT '극장연락처', 
    `theater_rep`     VARCHAR(50)     NOT NULL    COMMENT '극장대표자', 
    `reg_id`          VARCHAR(50)     NOT NULL    COMMENT '등록자 ID', 
    `reg_date`        DATETIME        NOT NULL    COMMENT '등록일시', 
    `reg_ip`          VARCHAR(50)     NOT NULL    COMMENT '등록 IP', 
    `mod_id`          VARCHAR(50)     NOT NULL    COMMENT '수정자 ID', 
    `mod_date`        DATETIME        NOT NULL    COMMENT '수정일시', 
    `mod_ip`          VARCHAR(50)     NOT NULL    COMMENT '수정 IP', 
    PRIMARY KEY (theater_id)
);

ALTER TABLE theater COMMENT '극장';


-- theater Table Create SQL
CREATE TABLE movie
(
    `movie_id`     INT             NOT NULL    AUTO_INCREMENT COMMENT '영화 ID', 
    `movie_name`   VARCHAR(500)    NOT NULL    COMMENT '영화명', 
    `release_day`  DATE            NOT NULL    COMMENT '개봉일', 
    `director`     VARCHAR(50)     NOT NULL    COMMENT '감독', 
    `runn_time`    INT             NOT NULL    COMMENT '러닝타임', 
    `genre_cd`     VARCHAR(50)     NOT NULL    COMMENT '장르코드', 
    `rating_cd`    VARCHAR(50)     NOT NULL    COMMENT '관람가등급코드', 
    `reg_id`       VARCHAR(50)     NOT NULL    COMMENT '등록자 ID', 
    `reg_date`     DATETIME        NOT NULL    COMMENT '등록일시', 
    `reg_ip`       VARCHAR(50)     NOT NULL    COMMENT '등록 IP', 
    `mod_id`       VARCHAR(50)     NOT NULL    COMMENT '수정자 ID', 
    `mod_date`     DATETIME        NOT NULL    COMMENT '수정일시', 
    `mod_ip`       VARCHAR(50)     NOT NULL    COMMENT '수정 IP', 
    PRIMARY KEY (movie_id)
);

ALTER TABLE movie COMMENT '영화';


-- theater Table Create SQL
CREATE TABLE screen
(
    `screen_id`    INT             NOT NULL    AUTO_INCREMENT COMMENT '상영관 ID', 
    `theater_id`   INT             NOT NULL    COMMENT '극장 ID', 
    `screen_name`  VARCHAR(500)    NOT NULL    COMMENT '상영관명', 
    `screen_cd`    VARCHAR(50)     NOT NULL    COMMENT '상영관구분코드', 
    `reg_id`       VARCHAR(50)     NOT NULL    COMMENT '등록자 ID', 
    `reg_date`     DATETIME        NOT NULL    COMMENT '등록일시', 
    `reg_ip`       VARCHAR(50)     NOT NULL    COMMENT '등록 IP', 
    `mod_id`       VARCHAR(50)     NOT NULL    COMMENT '수정자 ID', 
    `mod_date`     DATETIME        NOT NULL    COMMENT '수정일시', 
    `mod_ip`       VARCHAR(50)     NOT NULL    COMMENT '수정 IP', 
    PRIMARY KEY (screen_id)
);

ALTER TABLE screen COMMENT '상영관';

ALTER TABLE screen
    ADD CONSTRAINT FK_screen_theater_id_theater_theater_id FOREIGN KEY (theater_id)
        REFERENCES theater (theater_id) ON DELETE RESTRICT ON UPDATE RESTRICT;


-- theater Table Create SQL
CREATE TABLE member
(
    `member_id`     VARCHAR(50)     NOT NULL    COMMENT '회원 ID', 
    `name`          VARCHAR(50)     NOT NULL    COMMENT '성명', 
    `pwd`           VARCHAR(500)    NOT NULL    COMMENT '비밀번호', 
    `email`         VARCHAR(100)    NULL        COMMENT '이메일', 
    `phone_no`      VARCHAR(100)    NOT NULL    COMMENT '휴대폰번호', 
    `birth_day`     DATE            NULL        COMMENT '생년월일', 
    `join_day`      DATE            NOT NULL    COMMENT '가입일', 
    `joinout_yn`    VARCHAR(1)      NOT NULL    COMMENT '탈퇴여부', 
    `addr`          VARCHAR(500)    NULL        COMMENT '주소', 
    `cus_level_cd`  VARCHAR(50)     NOT NULL    COMMENT '고객등급코드', 
    `reg_id`        VARCHAR(50)     NOT NULL    COMMENT '등록자 ID', 
    `reg_date`      DATETIME        NOT NULL    COMMENT '등록일시', 
    `reg_ip`        VARCHAR(50)     NOT NULL    COMMENT '등록 IP', 
    `mod_id`        VARCHAR(50)     NOT NULL    COMMENT '수정자 ID', 
    `mod_date`      DATETIME        NOT NULL    COMMENT '수정일시', 
    `mod_ip`        VARCHAR(50)     NOT NULL    COMMENT '수정 IP', 
    PRIMARY KEY (member_id)
);

ALTER TABLE member COMMENT '회원';


-- theater Table Create SQL
CREATE TABLE movie_schedule
(
    `movie_sche_id`    INT            NOT NULL    AUTO_INCREMENT COMMENT '상영시간 ID', 
    `movie_id`         INT            NOT NULL    COMMENT '영화 ID', 
    `screen_id`        INT            NOT NULL    COMMENT '상영관 ID', 
    `theater_id`       INT            NOT NULL    COMMENT '극장 ID', 
    `show_day`         DATE           NOT NULL    COMMENT '상영일', 
    `show_start_time`  VARCHAR(50)    NOT NULL    COMMENT '상영시작시간', 
    `show_end_time`    VARCHAR(50)    NOT NULL    COMMENT '상영종료시간', 
    `reg_id`           VARCHAR(50)    NOT NULL    COMMENT '등록자 ID', 
    `reg_date`         DATETIME       NOT NULL    COMMENT '등록일시', 
    `reg_ip`           VARCHAR(50)    NOT NULL    COMMENT '등록 IP', 
    `mod_id`           VARCHAR(50)    NOT NULL    COMMENT '수정자 ID', 
    `mod_date`         DATETIME       NOT NULL    COMMENT '수정일시', 
    `mod_ip`           VARCHAR(50)    NOT NULL    COMMENT '수정 IP', 
    PRIMARY KEY (movie_sche_id)
);

ALTER TABLE movie_schedule COMMENT '상영시간표';

ALTER TABLE movie_schedule
    ADD CONSTRAINT FK_movie_schedule_movie_id_movie_movie_id FOREIGN KEY (movie_id)
        REFERENCES movie (movie_id) ON DELETE RESTRICT ON UPDATE RESTRICT;

ALTER TABLE movie_schedule
    ADD CONSTRAINT FK_movie_schedule_screen_id_screen_screen_id FOREIGN KEY (screen_id)
        REFERENCES screen (screen_id) ON DELETE RESTRICT ON UPDATE RESTRICT;


-- theater Table Create SQL
CREATE TABLE comm_code_group
(
    `groupcode_id`    VARCHAR(500)    NOT NULL    COMMENT '그룹코드 ID', 
    `groupcode_name`  VARCHAR(50)     NULL        COMMENT '그룹코드값', 
    `reg_id`          VARCHAR(50)     NOT NULL    COMMENT '등록자 ID', 
    `reg_dt`          DATETIME        NOT NULL    COMMENT '등록일시', 
    `reg_ip`          VARCHAR(50)     NOT NULL    COMMENT '등록 IP', 
    `mod_id`          VARCHAR(50)     NOT NULL    COMMENT '수정자 ID', 
    `mod_dt`          DATETIME        NOT NULL    COMMENT '수정일시', 
    `mod_ip`          VARCHAR(50)     NOT NULL    COMMENT '수정 IP', 
    PRIMARY KEY (groupcode_id)
);

ALTER TABLE comm_code_group COMMENT '공통코드그룹';


-- theater Table Create SQL
CREATE TABLE seat
(
    `screen_id`      INT            NOT NULL    COMMENT '상영관 ID', 
    `seat_id`        VARCHAR(10)    NOT NULL    COMMENT '좌석 ID', 
    `seat_price`     INT            NOT NULL    COMMENT '좌석가격', 
    `seat_level_cd`  VARCHAR(50)    NOT NULL    COMMENT '좌석등급코드', 
    `reg_id`         VARCHAR(50)    NOT NULL    COMMENT '등록자 ID', 
    `reg_date`       DATETIME       NOT NULL    COMMENT '등록일시', 
    `reg_ip`         VARCHAR(50)    NOT NULL    COMMENT '등록 IP', 
    `mod_id`         VARCHAR(50)    NOT NULL    COMMENT '수정자 ID', 
    `mod_date`       DATETIME       NOT NULL    COMMENT '수정일시', 
    `mod_ip`         VARCHAR(50)    NOT NULL    COMMENT '수정 IP', 
    PRIMARY KEY (screen_id, seat_id)
);

ALTER TABLE seat COMMENT '상영관좌석';

ALTER TABLE seat
    ADD CONSTRAINT FK_seat_screen_id_screen_screen_id FOREIGN KEY (screen_id)
        REFERENCES screen (screen_id) ON DELETE RESTRICT ON UPDATE RESTRICT;


-- theater Table Create SQL
CREATE TABLE booking
(
    `booking_id`       INT            NOT NULL    AUTO_INCREMENT COMMENT '예매번호', 
    `member_id`        VARCHAR(50)    NOT NULL    COMMENT '회원 ID', 
    `movie_sche_id`    INT            NOT NULL    COMMENT '상영시간 ID', 
    `payment_method`   VARCHAR(50)    NOT NULL    COMMENT '결제수단', 
    `payment_price`    INT            NOT NULL    COMMENT '결제금액', 
    `payment_day`      DATE           NOT NULL    COMMENT '결제일', 
    `payment_stat_cd`  VARCHAR(50)    NOT NULL    COMMENT '결제상태코드', 
    `reg_id`           VARCHAR(50)    NOT NULL    COMMENT '등록자 ID', 
    `reg_date`         DATETIME       NOT NULL    COMMENT '등록일시', 
    `reg_ip`           VARCHAR(50)    NOT NULL    COMMENT '등록 IP', 
    `mod_id`           VARCHAR(50)    NOT NULL    COMMENT '수정자 ID', 
    `mod_date`         DATETIME       NOT NULL    COMMENT '수정일시', 
    `mod_ip`           VARCHAR(50)    NOT NULL    COMMENT '수정 IP', 
    PRIMARY KEY (booking_id)
);

ALTER TABLE booking COMMENT '예매';

ALTER TABLE booking
    ADD CONSTRAINT FK_booking_movie_sche_id_movie_schedule_movie_sche_id FOREIGN KEY (movie_sche_id)
        REFERENCES movie_schedule (movie_sche_id) ON DELETE RESTRICT ON UPDATE RESTRICT;

ALTER TABLE booking
    ADD CONSTRAINT FK_booking_member_id_member_member_id FOREIGN KEY (member_id)
        REFERENCES member (member_id) ON DELETE RESTRICT ON UPDATE RESTRICT;


-- theater Table Create SQL
CREATE TABLE movie_theater_mapping
(
    `movie_id`          INT            NOT NULL    COMMENT '영화 ID', 
    `theater_id`        INT            NOT NULL    COMMENT '극장 ID', 
    `screen_start_day`  DATE           NULL        COMMENT '상영시작일', 
    `screen_end_day`    DATE           NULL        COMMENT '상영종료일', 
    `reg_id`            VARCHAR(50)    NOT NULL    COMMENT '등록자 ID', 
    `reg_date`          DATETIME       NOT NULL    COMMENT '등록일시', 
    `reg_ip`            VARCHAR(50)    NOT NULL    COMMENT '등록 IP', 
    `mod_id`            VARCHAR(50)    NOT NULL    COMMENT '수정자 ID', 
    `mod_date`          DATETIME       NOT NULL    COMMENT '수정일시', 
    `mod_ip`            VARCHAR(50)    NOT NULL    COMMENT '수정 IP', 
    PRIMARY KEY (movie_id, theater_id)
);

ALTER TABLE movie_theater_mapping COMMENT '영화극장맵핑';

ALTER TABLE movie_theater_mapping
    ADD CONSTRAINT FK_movie_theater_mapping_movie_id_movie_movie_id FOREIGN KEY (movie_id)
        REFERENCES movie (movie_id) ON DELETE RESTRICT ON UPDATE RESTRICT;

ALTER TABLE movie_theater_mapping
    ADD CONSTRAINT FK_movie_theater_mapping_theater_id_theater_theater_id FOREIGN KEY (theater_id)
        REFERENCES theater (theater_id) ON DELETE RESTRICT ON UPDATE RESTRICT;


-- theater Table Create SQL
CREATE TABLE comm_code
(
    `groupcode_id`  VARCHAR(500)    NOT NULL    COMMENT '그룹코드 ID', 
    `code_id`       VARCHAR(50)     NOT NULL    COMMENT '코드', 
    `code_name`     VARCHAR(500)    NOT NULL    COMMENT '코드값', 
    `use_yn`        VARCHAR(1)      NOT NULL    COMMENT '사용여부', 
    `reg_id`        VARCHAR(50)     NOT NULL    COMMENT '등록자 ID', 
    `reg_date`      DATETIME        NOT NULL    COMMENT '등록일시', 
    `reg_ip`        VARCHAR(50)     NOT NULL    COMMENT '등록 IP', 
    `mod_id`        VARCHAR(50)     NOT NULL    COMMENT '수정자 ID', 
    `mod_date`      DATETIME        NOT NULL    COMMENT '수정일시', 
    `mod_ip`        VARCHAR(50)     NOT NULL    COMMENT '수정 IP', 
    PRIMARY KEY (groupcode_id, code_id)
);

ALTER TABLE comm_code COMMENT '공통코드';

ALTER TABLE comm_code
    ADD CONSTRAINT FK_comm_code_groupcode_id_comm_code_group_groupcode_id FOREIGN KEY (groupcode_id)
        REFERENCES comm_code_group (groupcode_id) ON DELETE RESTRICT ON UPDATE RESTRICT;


